# INDEX 

### INDEX란?
데이터 베이스 테이블에서 조회 속도를 빠르게 향상시키기 위한 자료구조로 특정 컬럼에 대해 `정렬`한 후 Key, Value 형태로 `별도의 공간`에 저장한다. (메모리를 추가로 사용)   
즉, 컬럼에 대해 `정렬한 사본`이라고 볼 수 있다.

상황에 따라서 빠르게 `정렬(ORDER BY)`하거나 `그룹화(GROUP BY)`를 위해서 사용되기도 한다.
- 장점
    1. 조건 검색      
        <img src="https://user-images.githubusercontent.com/70866410/233834579-36475ab0-6f55-4dcf-9a9b-a394fd74a784.png">   
        - Index가 없을 경우 : 숫자 하나를 찾기 위해 모든 카드를 순회해야 한다. (Full Scan)   
        시간복잡도 : `O(N)`   
        - Index가 있을 경우 : 이분탐색을 통해 빠르게 연산할 수 있다.   
        시간복잡도 : `O(logN)`

        > 앞서 언급했듯, 이분탐색을 통해 찾을 수 있는 이유는 `정렬`이 되어있기 때문에 가능하다.

    2. 정렬 ORDER BY    
        - Index가 없는 컬럼을 정렬하려면 1차적으로 메모리에서 정렬이 이루어지고, 메모리에서 감당할 수 없을 정도의 큰 용량을 차지하면 디스크 I/O까지 발생하기 때문에 부하가 많이 걸린다.   
        그러나 Index가 존재하면 <b>이미 정렬</b>되어 있으므로 그대로 가져오면 부하를 막을 수 있다. 

- 단점   
    1. 추가적인 저장 공간의 필요
        - DB의 약 10 ~ 15% 에 해당하는 추가 공간이 필요하다.
    2. 데이터 변경에 취약
        - INSERT, UPDATE, DELETE를 통해 데이터가 변경되면 Index 테이블을 전부 다 재 정렬해야한다.
        - 실제로는 인덱스에서 UPDATE나 DELETE 연산을 수행할 경우 삭제하거나 내용이 수정되지 않고 `이 인덱스는 사용하지 않는다.`라고 마치 플래그처럼 처리한다.    
        때문에 인덱스에 계속 남아있어 비대해지고 오히려 성능이 떨어지게 된다.

### 동작 원리
테이블 생성 시 3가지의 파일이 생성된다.
- FRM : 테이블의 구조가 저장되어 있는 파일
- MYD : 실제 데이터가 저장되어 있는 파일
- MYI : 인덱스가 저장되어있는 파일

사용자가 Index가 적용되어있는 컬럼을 조회할 경우 MYI 파일의 내용을 활용하여 인덱스를 탐색한다.   

인덱스의 `Key`에는 DBMS의 옵티마이저에 의해 `정렬된 컬럼`이 있고   
`Value`에는 실제 데이터가 저장되어있는 `주소값`이 존재한다.   

그럼 해당 주소에 있는 데이터를 사용하는 것이다.

### 인덱스 사용 여부 결정
- 사용함으로서 성능 향상을 얻을 수 있는 경우
    - 조건 절 (WHERE) 에서 자주 사용되는 컬럼
    - 외래키 (Foreign Key) 로 사용되는 컬럼
    - Join에 사용되는 조건 컬럼
- 사용을 피해야 하는 경우
    - 데이터의 중복이 많은 컬럼
    - DML이 자주 사용되는 컬럼
    - Table에 데이터가 조금 있을 때

### Hash Index
해시 테이블을 이용해서 인덱스를 구현하는 방식이다.   
- 장점
    - 시간복잡도가 `O(1)`, 상수시간이다.   
- 단점
    - `Rehasing` 에 대한 부담이 존재한다.   
      > 리해싱이란 ? Array 형태의 자료구조에 Key, Value 형태로 저장이 되는데, 이 공간을 다 사용할 경우 공간 할당을 늘려줘야 한다. 이 것을 리해싱이라고 하고, 이는 부하가 큰 작업이다.
    - 같은지, 다른지 `Boolean` 타입의 비교만 가능하고 `범위(Range)` 탐색은 불가능하다.
    - 재사용성이 떨어진다.
        - B-tree 인덱스의 경우 복합 컬럼 `{a, b}` 를 Key 로 가지는 인덱스에서 `{a}` 만 조건으로 조회하고자 할 때 동일한 인덱스를 사용할 수 있다.   
        그러나 Hash Table 기반 인덱스는 불가능하다. 


### 예상 질문 ?
<details>
<summary>1. 데이터베이스에서 인덱스를 사용하는 이유 및 장단점에 대해 설명해주세요.</summary>
- 데이터베이스에서 인덱스를 사용하는 이유는 검색성능을 향상시키기 위함입니다.<br>
- 장점으로는 빠른 검색 성능을 들 수 있습니다.<br>
- 단점으로는 추가적인 저장 공간을 필요로 한다. DML이 많이 일어날 경우 인덱스가 비대해져 성능 하락의 가능성이 존재한다.<br>
</details>





### 참고자료
---
[DB 인덱스 : 깃허브 gyoogle 레포지토리](https://github.com/gyoogle/tech-interview-for-developer/blob/master/Computer%20Science/Database/%5BDB%5D%20Index.md)   
[인덱스란 ? : 코딩애플 유튜브](https://www.youtube.com/watch?v=iNvYsGKelYs&ab_channel=%EC%BD%94%EB%94%A9%EC%95%A0%ED%94%8C)   
[DB 인덱스 핵심 : 쉬운코드 유튜브](https://youtu.be/IMDH4iAQ6zM)